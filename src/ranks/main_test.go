package main

import (
	"fmt"
	"testing"
	"encoding/json"
)

func TestRankProvider(t *testing.T) {

	sources := []Source{
		Source("abcd efg"),
	}
	targets := []Target{
		Target{Text: "aaaa", Key: "1"},
		Target{Text: "abcd", Key: "2"},
		Target{Text: "abce", Key: "3"},
		Target{Text: "abcefg", Key: "4"},
		Target{Text: "abcd efg", Key: "5"},
		// The following also has a rank of 1 due to a limitation having to weighting subMatch against their source word,
		// instead of weighing against the target string. This is acceptable so far.
		// Target{Text: "abcdefg", Data: "6"},
		Target{Text: "acd fg", Key: "7"},
	}

	res := MatchSourceAndTargets(sources, targets)
	fmt.Println(res)
}

func TestCombine(t *testing.T) {
	var data = `{"targets":[{"text":"B Class B 250e Hatchback 4D","key":"https://www.kbb.com/mercedes-benz/b-class/2017/b-250e-hatchback-4d/?vehicleid=421029&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"C Class C 300 Sedan 4D","key":"https://www.kbb.com/mercedes-benz/c-class/2017/c-300-sedan-4d/?vehicleid=424080&intent=buy-used&category=sedan&modalview=false&pricetype=private-party&condition=good"},{"text":"C Class C 300 4MATIC Sedan 4D","key":"https://www.kbb.com/mercedes-benz/c-class/2017/c-300-4matic-sedan-4d/?vehicleid=424079&intent=buy-used&category=sedan&modalview=false&pricetype=private-party&condition=good"},{"text":"C Class C 350e Plug In Hybrid Sedan 4D","key":"https://www.kbb.com/mercedes-benz/c-class/2017/c-350e-plug-in-hybrid-sedan-4d/?vehicleid=436668&intent=buy-used&category=sedan&modalview=false&pricetype=private-party&condition=good"},{"text":"C Class C 300 Coupe 2D","key":"https://www.kbb.com/mercedes-benz/c-class/2017/c-300-coupe-2d/?vehicleid=419766&intent=buy-used&category=coupe&modalview=false&pricetype=private-party&condition=good"},{"text":"C Class C 300 4MATIC Coupe 2D","key":"https://www.kbb.com/mercedes-benz/c-class/2017/c-300-4matic-coupe-2d/?vehicleid=419767&intent=buy-used&category=coupe&modalview=false&pricetype=private-party&condition=good"},{"text":"C Class C 300 Cabriolet 2D","key":"https://www.kbb.com/mercedes-benz/c-class/2017/c-300-cabriolet-2d/?vehicleid=424093&intent=buy-used&category=convertible&modalview=false&pricetype=private-party&condition=good"},{"text":"C Class C 300 4MATIC Cabriolet 2D","key":"https://www.kbb.com/mercedes-benz/c-class/2017/c-300-4matic-cabriolet-2d/?vehicleid=424092&intent=buy-used&category=convertible&modalview=false&pricetype=private-party&condition=good"},{"text":"CLA CLA 250 Coupe 4D","key":"https://www.kbb.com/mercedes-benz/cla/2017/cla-250-coupe-4d/?vehicleid=422549&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"CLA CLA 250 4MATIC Coupe 4D","key":"https://www.kbb.com/mercedes-benz/cla/2017/cla-250-4matic-coupe-4d/?vehicleid=422550&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"CLS CLS 550 Coupe 4D","key":"https://www.kbb.com/mercedes-benz/cls/2017/cls-550-coupe-4d/?vehicleid=428577&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"CLS CLS 550 4MATIC Coupe 4D","key":"https://www.kbb.com/mercedes-benz/cls/2017/cls-550-4matic-coupe-4d/?vehicleid=428578&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"E Class E 400 Coupe 2D","key":"https://www.kbb.com/mercedes-benz/e-class/2017/e-400-coupe-2d/?vehicleid=420735&intent=buy-used&category=coupe&modalview=false&pricetype=private-party&condition=good"},{"text":"E Class E 400 4MATIC Coupe 2D","key":"https://www.kbb.com/mercedes-benz/e-class/2017/e-400-4matic-coupe-2d/?vehicleid=420739&intent=buy-used&category=coupe&modalview=false&pricetype=private-party&condition=good"},{"text":"E Class E 550 Coupe 2D","key":"https://www.kbb.com/mercedes-benz/e-class/2017/e-550-coupe-2d/?vehicleid=420738&intent=buy-used&category=coupe&modalview=false&pricetype=private-party&condition=good"},{"text":"E Class E 300 Sedan 4D","key":"https://www.kbb.com/mercedes-benz/e-class/2017/e-300-sedan-4d/?vehicleid=420737&intent=buy-used&category=sedan&modalview=false&pricetype=private-party&condition=good"},{"text":"E Class E 300 4MATIC Sedan 4D","key":"https://www.kbb.com/mercedes-benz/e-class/2017/e-300-4matic-sedan-4d/?vehicleid=420734&intent=buy-used&category=sedan&modalview=false&pricetype=private-party&condition=good"},{"text":"E Class E 400 Cabriolet 2D","key":"https://www.kbb.com/mercedes-benz/e-class/2017/e-400-cabriolet-2d/?vehicleid=420730&intent=buy-used&category=convertible&modalview=false&pricetype=private-party&condition=good"},{"text":"E Class E 550 Cabriolet 2D","key":"https://www.kbb.com/mercedes-benz/e-class/2017/e-550-cabriolet-2d/?vehicleid=420750&intent=buy-used&category=convertible&modalview=false&pricetype=private-party&condition=good"},{"text":"E Class E 400 4MATIC Wagon 4D","key":"https://www.kbb.com/mercedes-benz/e-class/2017/e-400-4matic-wagon-4d/?vehicleid=428515&intent=buy-used&category=wagon&modalview=false&pricetype=private-party&condition=good"},{"text":"G Class G 550 Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/g-class/2017/g-550-sport-utility-4d/?vehicleid=423595&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLA GLA 250 Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/gla/2017/gla-250-sport-utility-4d/?vehicleid=421571&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLA GLA 250 4MATIC Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/gla/2017/gla-250-4matic-sport-utility-4d/?vehicleid=421593&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLC GLC 300 Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/glc/2017/glc-300-sport-utility-4d/?vehicleid=421278&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLC GLC 300 4MATIC Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/glc/2017/glc-300-4matic-sport-utility-4d/?vehicleid=421276&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLC Coupe GLC 300 4MATIC Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/glc-coupe/2017/glc-300-4matic-sport-utility-4d/?vehicleid=429738&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLE GLE 350 4MATIC Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/gle/2017/gle-350-4matic-sport-utility-4d/?vehicleid=420910&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLE GLE 350 Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/gle/2017/gle-350-sport-utility-4d/?vehicleid=420925&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLE GLE 300d 4MATIC Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/gle/2017/gle-300d-4matic-sport-utility-4d/?vehicleid=429710&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLE GLE 400 4MATIC Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/gle/2017/gle-400-4matic-sport-utility-4d/?vehicleid=420907&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLE GLE 550e 4MATIC Plug In Hybrid Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/gle/2017/gle-550e-4matic-plug-in-hybrid-sport-utility-4d/?vehicleid=429711&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLS GLS 450 Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/gls/2017/gls-450-sport-utility-4d/?vehicleid=418698&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLS GLS 350d Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/gls/2017/gls-350d-sport-utility-4d/?vehicleid=418709&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"GLS GLS 550 Sport Utility 4D","key":"https://www.kbb.com/mercedes-benz/gls/2017/gls-550-sport-utility-4d/?vehicleid=418694&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Metris Cargo Van 2D","key":"https://www.kbb.com/mercedes-benz/metris-cargo/2017/van-2d/?vehicleid=424672&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Metris Passenger Van 4D","key":"https://www.kbb.com/mercedes-benz/metris-passenger/2017/van-4d/?vehicleid=424674&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Metris WORKER Cargo Van 2D","key":"https://www.kbb.com/mercedes-benz/metris-worker-cargo/2017/van-2d/?vehicleid=424768&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Metris WORKER Passenger Van 4D","key":"https://www.kbb.com/mercedes-benz/metris-worker-passenger/2017/van-4d/?vehicleid=424769&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"S Class S 550e Plug In Hybrid Sedan 4D","key":"https://www.kbb.com/mercedes-benz/s-class/2017/s-550e-plug-in-hybrid-sedan-4d/?vehicleid=421665&intent=buy-used&category=sedan&modalview=false&pricetype=private-party&condition=good"},{"text":"S Class S 550 Sedan 4D","key":"https://www.kbb.com/mercedes-benz/s-class/2017/s-550-sedan-4d/?vehicleid=421658&intent=buy-used&category=sedan&modalview=false&pricetype=private-party&condition=good"},{"text":"S Class S 550 4MATIC Sedan 4D","key":"https://www.kbb.com/mercedes-benz/s-class/2017/s-550-4matic-sedan-4d/?vehicleid=421662&intent=buy-used&category=sedan&modalview=false&pricetype=private-party&condition=good"},{"text":"S Class S 600 Sedan 4D","key":"https://www.kbb.com/mercedes-benz/s-class/2017/s-600-sedan-4d/?vehicleid=421656&intent=buy-used&category=sedan&modalview=false&pricetype=private-party&condition=good"},{"text":"S Class S 550 Cabriolet 2D","key":"https://www.kbb.com/mercedes-benz/s-class/2017/s-550-cabriolet-2d/?vehicleid=421667&intent=buy-used&category=convertible&modalview=false&pricetype=private-party&condition=good"},{"text":"S Class S 550 4MATIC Coupe 2D","key":"https://www.kbb.com/mercedes-benz/s-class/2017/s-550-4matic-coupe-2d/?vehicleid=421668&intent=buy-used&category=coupe&modalview=false&pricetype=private-party&condition=good"},{"text":"SL SL 450 Roadster 2D","key":"https://www.kbb.com/mercedes-benz/sl/2017/sl-450-roadster-2d/?vehicleid=429104&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"SL SL 550 Roadster 2D","key":"https://www.kbb.com/mercedes-benz/sl/2017/sl-550-roadster-2d/?vehicleid=429105&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"SLC SLC 300 Roadster 2D","key":"https://www.kbb.com/mercedes-benz/slc/2017/slc-300-roadster-2d/?vehicleid=428791&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 2500 Cargo Standard Roof w/144\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-2500-cargo/2017/standard-roof-w-144-wb-van-3d/?vehicleid=430488&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 2500 Cargo High Roof w/170\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-2500-cargo/2017/high-roof-w-170-wb-van-3d/?vehicleid=430489&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 2500 Cargo High Roof Extended w/170\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-2500-cargo/2017/high-roof-extended-w-170-wb-van-3d/?vehicleid=430490&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 2500 Crew Standard Roof w/144\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-2500-crew/2017/standard-roof-w-144-wb-van-3d/?vehicleid=430487&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 2500 Crew High Roof w/170\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-2500-crew/2017/high-roof-w-170-wb-van-3d/?vehicleid=430486&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 2500 Passenger Standard Roof w/144\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-2500-passenger/2017/standard-roof-w-144-wb-van-3d/?vehicleid=430496&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 2500 Passenger High Roof w/170\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-2500-passenger/2017/high-roof-w-170-wb-van-3d/?vehicleid=430497&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 3500 Cargo Standard Roof w/144\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-3500-cargo/2017/standard-roof-w-144-wb-van-3d/?vehicleid=430498&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 3500 Cargo High Roof w/170\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-3500-cargo/2017/high-roof-w-170-wb-van-3d/?vehicleid=430499&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 3500 Cargo High Roof Extended w/170\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-3500-cargo/2017/high-roof-extended-w-170-wb-van-3d/?vehicleid=430500&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 3500 XD Cargo Standard Roof w/144\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-3500-xd-cargo/2017/standard-roof-w-144-wb-van-3d/?vehicleid=430457&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 3500 XD Cargo High Roof w/170\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-3500-xd-cargo/2017/high-roof-w-170-wb-van-3d/?vehicleid=430458&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter 3500 XD Cargo High Roof Extended w/170\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-3500-xd-cargo/2017/high-roof-extended-w-170-wb-van-3d/?vehicleid=430459&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter WORKER Cargo Standard Roof w/144\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-worker-cargo/2017/standard-roof-w-144-wb-van-3d/?vehicleid=428807&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter WORKER Cargo High Roof w/170\" WB Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-worker-cargo/2017/high-roof-w-170-wb-van-3d/?vehicleid=428808&intent=buy-used&modalview=false&pricetype=private-party&condition=good"},{"text":"Sprinter WORKER Passenger Van 3D","key":"https://www.kbb.com/mercedes-benz/sprinter-worker-passenger/2017/van-3d/?vehicleid=429744&intent=buy-used&modalview=false&pricetype=private-party&condition=good"}],"sources":["mercedes benz eclass","Mercedes Benz E300-Designo sedan"]}`

	ranksRequest := RanksRequest{}
	json.Unmarshal([]byte(data), &ranksRequest)
	rankedTarget := MatchSourceAndTargets(ranksRequest.Sources, ranksRequest.Targets)
	fmt.Println(rankedTarget)
}
